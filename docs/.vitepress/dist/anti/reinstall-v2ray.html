<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>重装 v2ray - WS + TLS + Web + CloudFlare | 糖加盐的学习笔记</title>
    <meta name="description" content="Jan Tang">
    <meta name="generator" content="VitePress v1.0.0-rc.45">
    <link rel="preload stylesheet" href="/assets/style.Dk628FHO.css" as="style">
    
    <script type="module" src="/assets/app.Dwwds2T0.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Bu8hRsVA.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.iZPUC10f.js">
    <link rel="modulepreload" href="/assets/chunks/theme.DoSHwd2l.js">
    <link rel="modulepreload" href="/assets/anti_reinstall-v2ray.md.CYOdLSHp.lean.js">
    <link rel="icon" href="https://cdn.tangjiayan.com/logo.svg">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-c3508ec8></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-c3508ec8> Skip to content </a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar has-sidebar" data-v-f1e365da data-v-b9c8b02d><div class="wrapper" data-v-b9c8b02d><div class="container" data-v-b9c8b02d><div class="title" data-v-b9c8b02d><div class="VPNavBarTitle has-sidebar" data-v-b9c8b02d data-v-28a961f9><a class="title" href="/" data-v-28a961f9><!--[--><!--]--><!--[--><img class="VPImage logo" src="https://cdn.tangjiayan.com/logo.svg" alt data-v-35a7d0b8><!--]--><span data-v-28a961f9>糖加盐的学习笔记</span><!--[--><!--]--></a></div></div><div class="content" data-v-b9c8b02d><div class="content-body" data-v-b9c8b02d><!--[--><!--]--><div class="VPNavBarSearch search" data-v-b9c8b02d><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><!----><!----><div class="VPNavBarAppearance appearance" data-v-b9c8b02d data-v-ead91a81><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-ead91a81 data-v-b79b56d4 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-b79b56d4></span><span class="vpi-moon moon" data-v-b79b56d4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-b9c8b02d data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/tangjan" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-717b8b75><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-b9c8b02d data-v-9b536d0b data-v-e5380155><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-e5380155><span class="vpi-more-horizontal icon" data-v-e5380155></span></button><div class="menu" data-v-e5380155><div class="VPMenu" data-v-e5380155 data-v-97491713><!----><!--[--><!--[--><!----><div class="group" data-v-9b536d0b><div class="item appearance" data-v-9b536d0b><p class="label" data-v-9b536d0b>Appearance</p><div class="appearance-action" data-v-9b536d0b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-9b536d0b data-v-b79b56d4 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-b79b56d4></span><span class="vpi-moon moon" data-v-b79b56d4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-9b536d0b><div class="item social-links" data-v-9b536d0b><div class="VPSocialLinks social-links-list" data-v-9b536d0b data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/tangjan" aria-label="github" target="_blank" rel="noopener" data-v-ee7a9424 data-v-717b8b75><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-b9c8b02d data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-b9c8b02d><div class="divider-line" data-v-b9c8b02d></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-070ab83d><span class="vpi-align-left menu-icon" data-v-070ab83d></span><span class="menu-text" data-v-070ab83d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-c9ba27ad><button data-v-c9ba27ad>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-a9a9e638 data-v-ec846e01><div class="curtain" data-v-ec846e01></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-ec846e01><span class="visually-hidden" id="sidebar-aria-label" data-v-ec846e01> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-ec846e01><section class="VPSidebarItem level-0" data-v-ec846e01 data-v-f24171a4><!----><div class="items" data-v-f24171a4><!--[--><div class="VPSidebarItem level-1 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/index.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>WELCOME</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/update-log.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>更新日志</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-ec846e01><section class="VPSidebarItem level-0" data-v-ec846e01 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h2 class="text" data-v-f24171a4>未分类</h2><!----></div><div class="items" data-v-f24171a4><!--[--><section class="VPSidebarItem level-1 collapsible collapsed" data-v-f24171a4 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h3 class="text" data-v-f24171a4>未分类</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-f24171a4><span class="vpi-chevron-right caret-icon" data-v-f24171a4></span></div></div><div class="items" data-v-f24171a4><!--[--><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/unclassified/hyper-v/transfer-files-to-vm.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>向 Hyper-V 虚拟机中传输文件</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/unclassified/bitvise-access-denied.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>Bitvise Access Denied 问题</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-f24171a4 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h3 class="text" data-v-f24171a4>Git</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-f24171a4><span class="vpi-chevron-right caret-icon" data-v-f24171a4></span></div></div><div class="items" data-v-f24171a4><!--[--><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/unclassified/git/git-github.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>Git / GitHub 的基本使用</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/unclassified/git/connection-timed-out.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>GitHub Connection timed out 问题</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-f24171a4 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h3 class="text" data-v-f24171a4>Linux</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-f24171a4><span class="vpi-chevron-right caret-icon" data-v-f24171a4></span></div></div><div class="items" data-v-f24171a4><!--[--><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/unclassified/linux/full-name.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>常见命令的全称</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/unclassified/linux/user.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>用户管理</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-f24171a4 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h3 class="text" data-v-f24171a4>PhotoShop</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-f24171a4><span class="vpi-chevron-right caret-icon" data-v-f24171a4></span></div></div><div class="items" data-v-f24171a4><!--[--><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/unclassified/photoshop/clone-stamp.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>仿制图章工具</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-f24171a4 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h3 class="text" data-v-f24171a4>本科</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-f24171a4><span class="vpi-chevron-right caret-icon" data-v-f24171a4></span></div></div><div class="items" data-v-f24171a4><!--[--><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/unclassified/undergraduate/simulink-svpwm.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>基于 Simulink 的 SVPWM 仿真</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/unclassified/undergraduate/matlab-jigsaw.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>MATLAB 拼图游戏设计</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/unclassified/undergraduate/yolo-insulator.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>基于机器视觉 YOLO 目标检测算法的绝缘子及缺陷识别</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="group" data-v-ec846e01><section class="VPSidebarItem level-0" data-v-ec846e01 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h2 class="text" data-v-f24171a4>建站</h2><!----></div><div class="items" data-v-f24171a4><!--[--><section class="VPSidebarItem level-1 collapsible collapsed" data-v-f24171a4 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h3 class="text" data-v-f24171a4>建站</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-f24171a4><span class="vpi-chevron-right caret-icon" data-v-f24171a4></span></div></div><div class="items" data-v-f24171a4><!--[--><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/web-build/fake-douban.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>仿豆瓣主页静态页面</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/web-build/wordpress/windows-local-wordpress.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>Windows 本地 Wordpress CMS 搭建</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/web-build/caa-ssl.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>CAA 类型解析记录会影响 SSL 证书的申请</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/web-build/debug/Error-establishing-a-database-connection.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>XAMPP - phpmyadmin：Error establishing a database connection</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/web-build/url.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>url</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/web-build/jekyll-cv.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>jekyll 个人在线简历</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/web-build/webstackpage.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>WebStackPage 个人导航站</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-f24171a4 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h3 class="text" data-v-f24171a4>CSS</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-f24171a4><span class="vpi-chevron-right caret-icon" data-v-f24171a4></span></div></div><div class="items" data-v-f24171a4><!--[--><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/web-build/css/linear-gradient-tangjiayan.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>linear-gradient 渐变色</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-f24171a4 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h3 class="text" data-v-f24171a4>HTML</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-f24171a4><span class="vpi-chevron-right caret-icon" data-v-f24171a4></span></div></div><div class="items" data-v-f24171a4><!--[--><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/web-build/html/ruby.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>HTML 注音元素 &lt;ruby&gt;</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-f24171a4 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h3 class="text" data-v-f24171a4>JS</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-f24171a4><span class="vpi-chevron-right caret-icon" data-v-f24171a4></span></div></div><div class="items" data-v-f24171a4><!--[--><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/web-build/js/js-number-guessing.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>JavaScript 初探——猜数字小游戏</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/web-build/js/query-display.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>将 url 中的 query 字段显示在网页中</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-f24171a4 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h3 class="text" data-v-f24171a4>Markdown</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-f24171a4><span class="vpi-chevron-right caret-icon" data-v-f24171a4></span></div></div><div class="items" data-v-f24171a4><!--[--><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/web-build/markdown/github-style-table.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>GitHub-Style Table</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-f24171a4 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h3 class="text" data-v-f24171a4>Typecho</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-f24171a4><span class="vpi-chevron-right caret-icon" data-v-f24171a4></span></div></div><div class="items" data-v-f24171a4><!--[--><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/web-build/typecho/debian10-typecho.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>Debian 10 部署 Typecho</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/web-build/typecho/typecho-page-change.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>Typecho首页文章没排满就换页</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-f24171a4 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h3 class="text" data-v-f24171a4>VitePress</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-f24171a4><span class="vpi-chevron-right caret-icon" data-v-f24171a4></span></div></div><div class="items" data-v-f24171a4><!--[--><section class="VPSidebarItem level-2 collapsible collapsed" data-v-f24171a4 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h4 class="text" data-v-f24171a4>debug</h4><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-f24171a4><span class="vpi-chevron-right caret-icon" data-v-f24171a4></span></div></div><div class="items" data-v-f24171a4><!--[--><div class="VPSidebarItem level-3 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/web-build/vitepress/debug/spawn-git-ENOENT.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>spawn-git-ENOENT</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/web-build/vitepress/debug/listen-EACCES.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>Error: listen EACCES</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/web-build/vitepress/debug/ERR_TTY_INIT_FAILED.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>ERR_TTY_INIT_FAILED</p><!--]--></a><!----></div><!----></div><!--]--></div></section><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/web-build/vitepress/vitepress-github-pages.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>VitePress 部署到 Github Pages</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/web-build/vitepress/vitepress-tencent-cloud.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>Nginx 反向代理实现 VitePress 站点部署到腾讯云服务器</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/web-build/vitepress/vitepress-katex.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>VitePress 中使用 Katex</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-f24171a4 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h3 class="text" data-v-f24171a4>WordPress</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-f24171a4><span class="vpi-chevron-right caret-icon" data-v-f24171a4></span></div></div><div class="items" data-v-f24171a4><!--[--><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/web-build/wordpress/windows-local-wordpress.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>Windows 本地 Wordpress CMS 搭建</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="group" data-v-ec846e01><section class="VPSidebarItem level-0" data-v-ec846e01 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h2 class="text" data-v-f24171a4>编程</h2><!----></div><div class="items" data-v-f24171a4><!--[--><section class="VPSidebarItem level-1 collapsible collapsed" data-v-f24171a4 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h3 class="text" data-v-f24171a4>C++</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-f24171a4><span class="vpi-chevron-right caret-icon" data-v-f24171a4></span></div></div><div class="items" data-v-f24171a4><!--[--><section class="VPSidebarItem level-2" data-v-f24171a4 data-v-f24171a4><!----><div class="items" data-v-f24171a4><!--[--><section class="VPSidebarItem level-3 collapsible collapsed" data-v-f24171a4 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h5 class="text" data-v-f24171a4>输入/输出数据</h5><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-f24171a4><span class="vpi-chevron-right caret-icon" data-v-f24171a4></span></div></div><div class="items" data-v-f24171a4><!--[--><div class="VPSidebarItem level-4 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/programming/c++/input-output/cin-cout.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>cin / cout</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-4 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/programming/c++/input-output/getline.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>getline</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-3 collapsible collapsed" data-v-f24171a4 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h5 class="text" data-v-f24171a4>容器</h5><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-f24171a4><span class="vpi-chevron-right caret-icon" data-v-f24171a4></span></div></div><div class="items" data-v-f24171a4><!--[--><div class="VPSidebarItem level-4 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/programming/c++/containers/array.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>array</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-3 collapsible collapsed" data-v-f24171a4 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h5 class="text" data-v-f24171a4>debug</h5><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-f24171a4><span class="vpi-chevron-right caret-icon" data-v-f24171a4></span></div></div><div class="items" data-v-f24171a4><!--[--><div class="VPSidebarItem level-4 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/programming/c++/debug/nowcoder-use-stdarray-instead.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>牛客 Do not declare C-style arrays, use std::array<> instead</p><!--]--></a><!----></div><!----></div><!--]--></div></section><div class="VPSidebarItem level-3 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/programming/c++/format-specifier.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>格式说明符</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-3 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/programming/c++/default.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>default - C++</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section><section class="VPSidebarItem level-1 collapsible collapsed" data-v-f24171a4 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h3 class="text" data-v-f24171a4>VS Code</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-f24171a4><span class="vpi-chevron-right caret-icon" data-v-f24171a4></span></div></div><div class="items" data-v-f24171a4><!--[--><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/programming/vscode/vscode-cpp.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>VS Code 配置 C++ 运行环境</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/programming/vscode/commit-stuck.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>使用 VS Code 进行 git commit 一直加载</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/programming/vscode/vscode-hard-tab.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>VS Code 插件 markdownlint 提示 “no-hard-tabs”</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="group" data-v-ec846e01><section class="VPSidebarItem level-0" data-v-ec846e01 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h2 class="text" data-v-f24171a4>日语</h2><!----></div><div class="items" data-v-f24171a4><!--[--><section class="VPSidebarItem level-1 collapsible collapsed" data-v-f24171a4 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h3 class="text" data-v-f24171a4>五十音</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-f24171a4><span class="vpi-chevron-right caret-icon" data-v-f24171a4></span></div></div><div class="items" data-v-f24171a4><!--[--><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/japanese/gojuon/gojuon.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>五十音图</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/japanese/gojuon/confusing-gojuon.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>五十音图-易混淆标色版</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/japanese/gojuon/gojuon-stroke-order.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>五十音笔顺</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/japanese/gojuon/voiced.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>浊音/半浊音</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="group" data-v-ec846e01><section class="VPSidebarItem level-0" data-v-ec846e01 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h2 class="text" data-v-f24171a4>嵌入式</h2><!----></div><div class="items" data-v-f24171a4><!--[--><section class="VPSidebarItem level-1 collapsible collapsed" data-v-f24171a4 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h3 class="text" data-v-f24171a4>嵌入式</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-f24171a4><span class="vpi-chevron-right caret-icon" data-v-f24171a4></span></div></div><div class="items" data-v-f24171a4><!--[--><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/embeded/stm32-naming-rule.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>STM32 命名规则</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/embeded/stm32-light.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>STM32 点灯大师</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/embeded/stm32-blink.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>STM32 点灯大大师</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="group" data-v-ec846e01><section class="VPSidebarItem level-0 has-active" data-v-ec846e01 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h2 class="text" data-v-f24171a4>ANTI</h2><!----></div><div class="items" data-v-f24171a4><!--[--><section class="VPSidebarItem level-1 collapsible has-active" data-v-f24171a4 data-v-f24171a4><div class="item" role="button" tabindex="0" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><h3 class="text" data-v-f24171a4>ANTI</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-f24171a4><span class="vpi-chevron-right caret-icon" data-v-f24171a4></span></div></div><div class="items" data-v-f24171a4><!--[--><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/anti/whats-anti.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>ANTI 是什么</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link link" href="/anti/reinstall-v2ray.html" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>重装 v2ray - WS + TLS + Web + CloudFlare</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><div class="group" data-v-ec846e01><section class="VPSidebarItem level-0" data-v-ec846e01 data-v-f24171a4><!----><div class="items" data-v-f24171a4><!--[--><div class="VPSidebarItem level-1 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link vp-external-link-icon link" href="https://www.tangjiayan.cn" target="_blank" rel="noreferrer" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>www.tangjiayan.cn</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link vp-external-link-icon link" href="https://old-notes.tangjiayan.cn" target="_blank" rel="noreferrer" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>旧笔记站</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-f24171a4 data-v-f24171a4><div class="item" data-v-f24171a4><div class="indicator" data-v-f24171a4></div><a class="VPLink link vp-external-link-icon link" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noreferrer" data-v-f24171a4><!--[--><p class="text" data-v-f24171a4>CC BY-NC-SA 4.0</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-sidebar has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-6d7b3c46 data-v-c14bfc45><div class="content" data-v-c14bfc45><div class="outline-marker" data-v-c14bfc45></div><div class="outline-title" role="heading" aria-level="2" data-v-c14bfc45>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-c14bfc45><span class="visually-hidden" id="doc-outline-aria-label" data-v-c14bfc45> Table of Contents for current page </span><ul class="VPDocOutlineItem root" data-v-c14bfc45 data-v-3f927ebe><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _anti_reinstall-v2ray" data-v-83890dd9><div><h1 id="重装-v2ray-ws-tls-web-cloudflare" tabindex="-1">重装 v2ray - WS + TLS + Web + CloudFlare <a class="header-anchor" href="#重装-v2ray-ws-tls-web-cloudflare" aria-label="Permalink to &quot;重装 v2ray - WS + TLS + Web + CloudFlare&quot;">​</a></h1><h2 id="序" tabindex="-1">序 <a class="header-anchor" href="#序" aria-label="Permalink to &quot;序&quot;">​</a></h2><p>2023/8/30，今天翻墙服务器突然就没用了。</p><p>首先在 <a href="https://ping.pe/" target="_blank" rel="noreferrer">ping.pe</a> 确认一下是不是我的服务器 IP 地址被墙了：</p><p><img src="https://cdn.tangjiayan.com/reinstall-v2ray/1-ping.be.png" alt="ping.be"></p><p>我是江苏电信网络，从图中可以看到，<code>Jiangsu China Telecom</code> 的丢包率是 <code>15%</code>，还算正常。因此问题出在我的服务器或客户端上。</p><p>尝试了以下方案，都没有用：</p><ul><li>更新服务器端、更新客户端</li><li>更换服务器端 v2ray 端口</li><li>重设 服务器时间（v2ray 要求服务器和客户端时间差绝对值不能超过 90 秒，参见 <a href="https://guide.v2fly.org/prep/start.html#%E6%97%B6%E9%97%B4%E6%98%AF%E5%90%A6%E5%87%86%E7%A1%AE" target="_blank" rel="noopener">这里</a>）</li></ul><p>所以干脆重装一下 v2ray 吧。</p><p>根据 <a href="https://github.com/v2fly/v2ray-examples/tree/master/how-to-choose#%E5%A6%82%E4%BD%95%E9%80%89%E6%8B%A9-v2ray-%E6%96%B9%E6%A1%88">如何选择 v2ray 方案</a> 考虑了一下，决定采用 <code>Nginx</code> + <code>TLS</code> + <code>WS</code>。于是主要参考 <a href="https://ericclose.github.io/V2Ray-TLS-WebSocket-Nginx-with-Cloudflare.html" target="_blank" rel="noreferrer">V2Ray (WebSocket + TLS + Web + Cloudflare) 手动配置详细说明 - Eric</a> 重装了一下 v2ray。</p><p>本文略去了：</p><ul><li>服务器购买及 SSH 连接</li><li>域名购买注册</li></ul><h2 id="重装服务器系统为-debian-10" tabindex="-1">重装服务器系统为 Debian 10 <a class="header-anchor" href="#重装服务器系统为-debian-10" aria-label="Permalink to &quot;重装服务器系统为 Debian 10&quot;">​</a></h2><p>首先更新一下系统，我的服务器系统是 <code>CentOS 7.9.2009</code>，有点旧了。</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/redhat-release</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CentOS</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Linux</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> release</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 7.9</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">.2009</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (Core)</span></span></code></pre></div><p>我的服务器是在 <a href="https://www.racknerd.com/" target="_blank" rel="noreferrer">RackNerd</a> 买的，在 RackNerd 服务器管理界面进入 <code>Control Panel</code>（登入Control Panel 的初始账号密码在购买服务器时发送到了注册邮箱），将服务器系统重置为 <code>Debian 10</code>。</p><p><img src="https://cdn.tangjiayan.com/reinstall-v2ray/2-reinstall-Debian.png" alt="reinstall-Debian"></p><h2 id="v2ray-安装前准备及安装" tabindex="-1">v2ray 安装前准备及安装 <a class="header-anchor" href="#v2ray-安装前准备及安装" aria-label="Permalink to &quot;v2ray 安装前准备及安装&quot;">​</a></h2><p>以下过程均是以 <code>root</code> 身份运行的。</p><p>最好不要这样，因为一旦手滑 <code>rm -rf /*</code> 就不好了。所以最好用非 root 用户，通过 <code>sudo</code> 执行 root 指令。</p><h3 id="更新-apt、安装-curl" tabindex="-1">更新 apt、安装 curl <a class="header-anchor" href="#更新-apt、安装-curl" aria-label="Permalink to &quot;更新 apt、安装 curl&quot;">​</a></h3><p>重装好系统后，先更新一下 <a href="https://en.wikipedia.org/wiki/APT_(software)" target="_blank" rel="noreferrer">apt</a>，安装 <a href="https://en.wikipedia.org/wiki/CURL" target="_blank" rel="noreferrer">curl</a></p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt-get</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --allow-releaseinfo-change</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> update</span></span></code></pre></div><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dist-upgrade</span></span></code></pre></div><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -y</span></span></code></pre></div><h3 id="校正系统时间" tabindex="-1">校正系统时间 <a class="header-anchor" href="#校正系统时间" aria-label="Permalink to &quot;校正系统时间&quot;">​</a></h3><p>v2ray 要求服务器和客户端时间差绝对值不能超过90 秒，参见 <a href="https://guide.v2fly.org/prep/start.html#%E6%97%B6%E9%97%B4%E6%98%AF%E5%90%A6%E5%87%86%E7%A1%AE" target="_blank" rel="noopener">这里</a></p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">timedatectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> list-timezones</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> grep</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Shanghai</span></span></code></pre></div><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">timedatectl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set-timezone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Asia/Shanghai</span></span></code></pre></div><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">date</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -R</span></span></code></pre></div><h3 id="安装-ufw" tabindex="-1">安装 ufw <a class="header-anchor" href="#安装-ufw" aria-label="Permalink to &quot;安装 ufw&quot;">​</a></h3><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ufw</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ufw</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ufw</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> allow</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;OpenSSH&#39;</span></span></code></pre></div><h3 id="安装-v2ray" tabindex="-1">安装 v2ray <a class="header-anchor" href="#安装-v2ray" aria-label="Permalink to &quot;安装 v2ray&quot;">​</a></h3><p>通过 <a href="https://github.com/v2fly/fhs-install-v2ray" target="_blank" rel="noreferrer">fhs-install-v2ray</a> 安装 v2ray。</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bash</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &lt;(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">curl</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://raw.githubusercontent.com/v2fly/fhs-install-v2ray/master/install-release.sh)</span></span></code></pre></div><p><img src="https://cdn.tangjiayan.com/reinstall-v2ray/3-instal-v2ray.png" alt="instal-v2ray"></p><p>根据安装完成后的提示，顺便运行一下：</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">apt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> purge</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> curl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> unzip</span></span></code></pre></div><p>接下来的步骤我用 <a href="https://www.netsarang.com/en/free-for-home-school/" target="_blank" rel="noreferrer">Xshell for home/school</a> 作为 <a href="https://en.wikipedia.org/wiki/Command-line_interface" target="_blank" rel="noreferrer">CLI</a>，用 <a href="https://www.bitvise.com/">Bitvise</a> 进行 <a href="https://en.wikipedia.org/wiki/SSH_File_Transfer_Protocol" target="_blank" rel="noreferrer">SFTP</a> 文件修改、传输。</p><h2 id="配置-v2ray" tabindex="-1">配置 v2ray <a class="header-anchor" href="#配置-v2ray" aria-label="Permalink to &quot;配置 v2ray&quot;">​</a></h2><p>配置 <code>/usr/local/etc/v2ray/config.json</code>，内容如下</p><details class="details custom-block"><summary>config.json</summary><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;log&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;loglevel&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;warning&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;routing&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;domainStrategy&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;AsIs&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        &quot;rules&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:[</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;type&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;field&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;ip&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:[</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">                    &quot;geoip:private&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                ],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;outboundTag&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;block&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;inbounds&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:[</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            &quot;listen&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;127.0.0.1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            &quot;port&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">&lt;端口&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            &quot;protocol&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;vmess&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            &quot;settings&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;clients&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:[</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                    {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                        &quot;id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">&lt;uuid&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                        &quot;alterId&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            &quot;streamSettings&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;network&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ws&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                &quot;wsSettings&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">                    &quot;path&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#B31D28;--shiki-dark:#FDAEB7;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">&lt;path&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">                }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;outbounds&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:[</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            &quot;protocol&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;freedom&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            &quot;tag&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;direct&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            &quot;protocol&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;blackhole&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">            &quot;tag&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;block&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></details><p>其中：</p><ul><li><code>&lt;端口&gt;</code>：自定</li><li><code>&lt;uuid&gt;</code>：可通过 <a href="https://www.v2fly.org/awesome/tools.html#%E5%9C%A8%E7%BA%BF%E5%B7%A5%E5%85%B7" target="_blank" rel="noreferrer">UUID 生成器</a> 或 <a href="https://www.uuidgenerator.net/" target="_blank" rel="noreferrer">Online UUID Generator</a> 生成</li><li><code>&lt;path&gt;</code>：自定</li></ul><p><code>&lt;uuid&gt;</code> 和 <code>&lt;path&gt;</code> 记得用 <code>英文引号</code> 括起来。</p><h2 id="cloudflare-域名解析" tabindex="-1">CloudFlare 域名解析 <a class="header-anchor" href="#cloudflare-域名解析" aria-label="Permalink to &quot;CloudFlare 域名解析&quot;">​</a></h2><p>CloudFlare 接管了域名解析之后，在 CloudFlare 添加以下两条 DNS 记录：</p><!----><h2 id="安装-nginx-及其初始配置" tabindex="-1">安装 Nginx 及其初始配置 <a class="header-anchor" href="#安装-nginx-及其初始配置" aria-label="Permalink to &quot;安装 Nginx 及其初始配置&quot;">​</a></h2><p>参考 <a href="https://ericclose.github.io/V2Ray-TLS-WebSocket-Nginx-with-Cloudflare.html#%E5%AE%89%E8%A3%85-Nginx-%E5%8F%8A%E5%85%B6%E5%88%9D%E5%A7%8B%E9%85%8D%E7%BD%AE" target="_blank" rel="noreferrer">安装 Nginx 及其初始配置</a></p><h2 id="cloudflare-生成-tls-证书、部署-authenticated-origin-pulls" tabindex="-1">CloudFlare 生成 TLS 证书、部署 Authenticated Origin Pulls <a class="header-anchor" href="#cloudflare-生成-tls-证书、部署-authenticated-origin-pulls" aria-label="Permalink to &quot;CloudFlare 生成 TLS 证书、部署 Authenticated Origin Pulls&quot;">​</a></h2><h3 id="tls-证书及私钥" tabindex="-1">TLS 证书及私钥 <a class="header-anchor" href="#tls-证书及私钥" aria-label="Permalink to &quot;TLS 证书及私钥&quot;">​</a></h3><p><code>CloudFlare 仪表盘</code> → <code>SSL/TLS</code> → <code>Origin Server</code> → <code>Create Certificate</code></p><p>因为「The private key data will not be stored at Cloudflare and will no longer be accessible once the creation is complete」，所以要保存好。</p><p><img src="https://cdn.tangjiayan.com/reinstall-v2ray/5-Cloudflare-TLS-Generate.png" alt="Cloudflare-TLS-Generate"></p><p>把证书和私钥都保存在 <code>/etc/ssl/cloudflare</code> 内。</p><h3 id="authenticated-origin-pulls" tabindex="-1">Authenticated Origin Pulls <a class="header-anchor" href="#authenticated-origin-pulls" aria-label="Permalink to &quot;Authenticated Origin Pulls&quot;">​</a></h3><blockquote><p>When you enable Authenticated Origin Pulls for a zone, all proxied traffic to your zone is authenticated at the origin web server. —— <a href="https://developers.cloudflare.com/ssl/origin-configuration/authenticated-origin-pull/set-up/zone-level/#zone-level-authenticated-origin-pulls">Zone-level authenticated origin pulls · Cloudflare SSL/TLS docs</a></p></blockquote><p>也就是说，如果在 Nginx 服务器上设置了 <code>Authenticated Origin Pulls</code>，就可以确保它只接受来自 Cloudflare 服务器的请求，防止任何其他人直接连接到 Nginx 服务器。</p><p>复制 <code>authenticated_origin_pull_ca.pem</code> 证书的内容，同样放在 <code>/etc/ssl/cloudflare</code> 内。</p><details class="details custom-block"><summary>authenticated_origin_pull_ca.pem</summary><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>-----BEGIN CERTIFICATE-----</span></span>
<span class="line"><span>MIIGCjCCA/KgAwIBAgIIV5G6lVbCLmEwDQYJKoZIhvcNAQENBQAwgZAxCzAJBgNV</span></span>
<span class="line"><span>BAYTAlVTMRkwFwYDVQQKExBDbG91ZEZsYXJlLCBJbmMuMRQwEgYDVQQLEwtPcmln</span></span>
<span class="line"><span>aW4gUHVsbDEWMBQGA1UEBxMNU2FuIEZyYW5jaXNjbzETMBEGA1UECBMKQ2FsaWZv</span></span>
<span class="line"><span>cm5pYTEjMCEGA1UEAxMab3JpZ2luLXB1bGwuY2xvdWRmbGFyZS5uZXQwHhcNMTkx</span></span>
<span class="line"><span>MDEwMTg0NTAwWhcNMjkxMTAxMTcwMDAwWjCBkDELMAkGA1UEBhMCVVMxGTAXBgNV</span></span>
<span class="line"><span>BAoTEENsb3VkRmxhcmUsIEluYy4xFDASBgNVBAsTC09yaWdpbiBQdWxsMRYwFAYD</span></span>
<span class="line"><span>VQQHEw1TYW4gRnJhbmNpc2NvMRMwEQYDVQQIEwpDYWxpZm9ybmlhMSMwIQYDVQQD</span></span>
<span class="line"><span>ExpvcmlnaW4tcHVsbC5jbG91ZGZsYXJlLm5ldDCCAiIwDQYJKoZIhvcNAQEBBQAD</span></span>
<span class="line"><span>ggIPADCCAgoCggIBAN2y2zojYfl0bKfhp0AJBFeV+jQqbCw3sHmvEPwLmqDLqynI</span></span>
<span class="line"><span>42tZXR5y914ZB9ZrwbL/K5O46exd/LujJnV2b3dzcx5rtiQzso0xzljqbnbQT20e</span></span>
<span class="line"><span>ihx/WrF4OkZKydZzsdaJsWAPuplDH5P7J82q3re88jQdgE5hqjqFZ3clCG7lxoBw</span></span>
<span class="line"><span>hLaazm3NJJlUfzdk97ouRvnFGAuXd5cQVx8jYOOeU60sWqmMe4QHdOvpqB91bJoY</span></span>
<span class="line"><span>QSKVFjUgHeTpN8tNpKJfb9LIn3pun3bC9NKNHtRKMNX3Kl/sAPq7q/AlndvA2Kw3</span></span>
<span class="line"><span>Dkum2mHQUGdzVHqcOgea9BGjLK2h7SuX93zTWL02u799dr6Xkrad/WShHchfjjRn</span></span>
<span class="line"><span>aL35niJUDr02YJtPgxWObsrfOU63B8juLUphW/4BOjjJyAG5l9j1//aUGEi/sEe5</span></span>
<span class="line"><span>lqVv0P78QrxoxR+MMXiJwQab5FB8TG/ac6mRHgF9CmkX90uaRh+OC07XjTdfSKGR</span></span>
<span class="line"><span>PpM9hB2ZhLol/nf8qmoLdoD5HvODZuKu2+muKeVHXgw2/A6wM7OwrinxZiyBk5Hh</span></span>
<span class="line"><span>CvaADH7PZpU6z/zv5NU5HSvXiKtCzFuDu4/Zfi34RfHXeCUfHAb4KfNRXJwMsxUa</span></span>
<span class="line"><span>+4ZpSAX2G6RnGU5meuXpU5/V+DQJp/e69XyyY6RXDoMywaEFlIlXBqjRRA2pAgMB</span></span>
<span class="line"><span>AAGjZjBkMA4GA1UdDwEB/wQEAwIBBjASBgNVHRMBAf8ECDAGAQH/AgECMB0GA1Ud</span></span>
<span class="line"><span>DgQWBBRDWUsraYuA4REzalfNVzjann3F6zAfBgNVHSMEGDAWgBRDWUsraYuA4REz</span></span>
<span class="line"><span>alfNVzjann3F6zANBgkqhkiG9w0BAQ0FAAOCAgEAkQ+T9nqcSlAuW/90DeYmQOW1</span></span>
<span class="line"><span>QhqOor5psBEGvxbNGV2hdLJY8h6QUq48BCevcMChg/L1CkznBNI40i3/6heDn3IS</span></span>
<span class="line"><span>zVEwXKf34pPFCACWVMZxbQjkNRTiH8iRur9EsaNQ5oXCPJkhwg2+IFyoPAAYURoX</span></span>
<span class="line"><span>VcI9SCDUa45clmYHJ/XYwV1icGVI8/9b2JUqklnOTa5tugwIUi5sTfipNcJXHhgz</span></span>
<span class="line"><span>6BKYDl0/UP0lLKbsUETXeTGDiDpxZYIgbcFrRDDkHC6BSvdWVEiH5b9mH2BON60z</span></span>
<span class="line"><span>0O0j8EEKTwi9jnafVtZQXP/D8yoVowdFDjXcKkOPF/1gIh9qrFR6GdoPVgB3SkLc</span></span>
<span class="line"><span>5ulBqZaCHm563jsvWb/kXJnlFxW+1bsO9BDD6DweBcGdNurgmH625wBXksSdD7y/</span></span>
<span class="line"><span>fakk8DagjbjKShYlPEFOAqEcliwjF45eabL0t27MJV61O/jHzHL3dknXeE4BDa2j</span></span>
<span class="line"><span>bA+JbyJeUMtU7KMsxvx82RmhqBEJJDBCJ3scVptvhDMRrtqDBW5JShxoAOcpFQGm</span></span>
<span class="line"><span>iYWicn46nPDjgTU0bX1ZPpTpryXbvciVL5RkVBuyX2ntcOLDPlZWgxZCBp96x07F</span></span>
<span class="line"><span>AnOzKgZk4RzZPNAxCXERVxajn/FLcOhglVAKo5H0ac+AitlQ0ip55D2/mf8o72tM</span></span>
<span class="line"><span>fVQ6VpyjEXdiIXWUq/o=</span></span>
<span class="line"><span>-----END CERTIFICATE-----</span></span></code></pre></div></details><p><img src="https://cdn.tangjiayan.com/reinstall-v2ray/cloudflare-tls-auth.png" alt="save-the-TLS"></p><h2 id="nginx-证书和密钥、反向代理的配置" tabindex="-1">Nginx 证书和密钥、反向代理的配置 <a class="header-anchor" href="#nginx-证书和密钥、反向代理的配置" aria-label="Permalink to &quot;Nginx 证书和密钥、反向代理的配置&quot;">​</a></h2><p>参考 <a href="https://ericclose.github.io/V2Ray-TLS-WebSocket-Nginx-with-Cloudflare.html#Nginx-%E8%AF%81%E4%B9%A6%E5%92%8C%E5%AF%86%E9%92%A5%E3%80%81%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E7%9A%84%E9%85%8D%E7%BD%AE" target="_blank" rel="noreferrer">Nginx 证书和密钥、反向代理的配置</a> 。</p><p>对于本文需要注意的是，我在上文把 CloudFlare 的证书都放在了 <code>/etc/ssl/cloudflare</code> 下，因此 <code>ssl_certificate</code>、<code>ssl_certificate_key</code>、<code>ssl_client_certificate</code> 需要对应修改。</p><h2 id="后续步骤" tabindex="-1">后续步骤 <a class="header-anchor" href="#后续步骤" aria-label="Permalink to &quot;后续步骤&quot;">​</a></h2><p>后续步骤：</p><ul><li>自启并启动相关服务</li><li>TCP BBR</li><li>v2rayN 客户端配置</li><li>优选 CloudFlare CDN 节点 IP</li></ul><p>参考 <a href="https://ericclose.github.io/V2Ray-TLS-WebSocket-Nginx-with-Cloudflare.html#%E8%87%AA%E5%90%AF%E5%B9%B6%E5%90%AF%E5%8A%A8%E7%9B%B8%E5%85%B3%E6%9C%8D%E5%8A%A1" target="_blank" rel="noreferrer">V2Ray (WebSocket + TLS + Web + Cloudflare) 手动配置详细说明 - Eric</a></p><h2 id="参考" tabindex="-1">参考 <a class="header-anchor" href="#参考" aria-label="Permalink to &quot;参考&quot;">​</a></h2><ul><li><a href="https://ericclose.github.io/V2Ray-TLS-WebSocket-Nginx-with-Cloudflare.html" target="_blank" rel="noreferrer">V2Ray (WebSocket + TLS + Web + Cloudflare) 手动配置详细说明 - Eric</a></li><li><a href="https://www.ddddl.com/archives/1648/debian-apt%E6%9B%B4%E6%96%B0%E5%A4%B1%E8%B4%A5%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95/" target="_blank" rel="noreferrer">Debian apt更新失败处理方法 – 幽静森林</a></li><li><a href="https://guide.v2fly.org/" target="_blank" rel="noreferrer">V2Ray 配置指南 | 新 V2Ray 白话文指南</a></li></ul></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-87be45d1><!--[--><!--]--><div class="edit-info" data-v-87be45d1><div class="edit-link" data-v-87be45d1><a class="VPLink link vp-external-link-icon no-icon edit-link-button" href="https://github.com/tangjan/tangjan.github.io/edit/main/docs/anti/reinstall-v2ray.md" target="_blank" rel="noreferrer" data-v-87be45d1><!--[--><span class="vpi-square-pen edit-link-icon" data-v-87be45d1></span> 在 GitHub 上编辑此页面<!--]--></a></div><!----></div><nav class="prev-next" data-v-87be45d1><div class="pager" data-v-87be45d1><a class="VPLink link pager-link prev" href="/anti/whats-anti.html" data-v-87be45d1><!--[--><span class="desc" data-v-87be45d1>Previous page</span><span class="title" data-v-87be45d1>ANTI 是什么</span><!--]--></a></div><div class="pager" data-v-87be45d1><a class="VPLink link vp-external-link-icon pager-link next" href="https://www.tangjiayan.cn" target="_blank" rel="noreferrer" data-v-87be45d1><!--[--><span class="desc" data-v-87be45d1>Next page</span><span class="title" data-v-87be45d1>www.tangjiayan.cn</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"programming_vscode_vscode-hard-tab.md\":\"TPiL3GLY\",\"unclassified_git_connection-timed-out.md\":\"B-SmBZtz\",\"unclassified_linux_full-name.md\":\"W24cSsvY\",\"programming_c___input-output_cin-cout.md\":\"D-bZssBB\",\"web-build_caa-ssl.md\":\"CjDHgCHW\",\"unclassified_undergraduate_yolo-insulator.md\":\"BIY52-lg\",\"programming_vscode_commit-stuck.md\":\"b8_hUR8n\",\"unclassified_hyper-v_transfer-files-to-vm.md\":\"DDvy_uVH\",\"japanese_gojuon_voiced.md\":\"B_7fX-0e\",\"programming_c___debug_nowcoder-use-stdarray-instead.md\":\"DJTN5pYA\",\"unclassified_bitvise-access-denied.md\":\"FbowjmC-\",\"anti_whats-anti.md\":\"iJMZv2n6\",\"web-build_typecho_typecho-page-change.md\":\"BVp-fuiH\",\"unclassified_linux_user.md\":\"CBofZ-iu\",\"index.md\":\"DV35gr_c\",\"programming_c___containers_array.md\":\"kdgpvhGU\",\"unclassified_photoshop_clone-stamp.md\":\"a0JNTDkv\",\"web-build_vitepress_debug_listen-eacces.md\":\"FxLH5fwZ\",\"web-build_html_ruby.md\":\"Dz8xMlb1\",\"web-build_vitepress_debug_err_tty_init_failed.md\":\"BQcBMa5u\",\"japanese_gojuon_gojuon-stroke-order.md\":\"C4JdjWtV\",\"web-build_url.md\":\"ChepVimY\",\"embeded_stm32-naming-rule.md\":\"JGJYVKDI\",\"web-build_vitepress_debug_spawn-git-enoent.md\":\"B145vKRl\",\"web-build_js_query-display.md\":\"sEbjOLA9\",\"unclassified_git_git-github.md\":\"CuZdUVq1\",\"embeded_stm32-light.md\":\"DSVbe3Yk\",\"programming_c___input-output_getline.md\":\"CDNPQdRP\",\"web-build_css_linear-gradient-tangjiayan.md\":\"8zu_Jsw2\",\"update-log.md\":\"CewopBet\",\"programming_c___format-specifier.md\":\"CYb_8zWp\",\"programming_c___default.md\":\"B03UKjTV\",\"programming_vscode_vscode-cpp.md\":\"B9bJWckE\",\"embeded_stm32-blink.md\":\"D_zI4kno\",\"web-build_markdown_query-display.md\":\"i90ej_DE\",\"anti_reinstall-v2ray.md\":\"CYOdLSHp\",\"web-build_wordpress_windows-local-wordpress.md\":\"BMOkSCDH\",\"unclassified_undergraduate_matlab-jigsaw.md\":\"BAR-UG0u\",\"web-build_vitepress_vitepress-github-pages.md\":\"BKwpiQIT\",\"japanese_gojuon_gojuon.md\":\"DBXjiSdW\",\"web-build_debug_error-establishing-a-database-connection.md\":\"THHcen1K\",\"web-build_vitepress_vitepress-tencent-cloud.md\":\"Clvze1HO\",\"web-build_jekyll-cv.md\":\"eASPx-Et\",\"web-build_markdown_github-style-table.md\":\"YgDnbLGN\",\"web-build_typecho_debian10-typecho.md\":\"kKSp82cl\",\"japanese_gojuon_confusing-gojuon.md\":\"CZEh59aO\",\"web-build_fake-douban.md\":\"D8WM7Fwi\",\"web-build_vitepress_vitepress-katex.md\":\"BvDarvp9\",\"web-build_js_js-number-guessing.md\":\"DA3fxcV4\",\"unclassified_undergraduate_simulink-svpwm.md\":\"B5Q9dLAK\",\"web-build_webstackpage.md\":\"ClCZN4Dl\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-CN\",\"dir\":\"ltr\",\"title\":\"糖加盐的学习笔记\",\"description\":\"Jan Tang\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"editLink\":{\"pattern\":\"https://github.com/tangjan/tangjan.github.io/edit/main/docs/:path\",\"text\":\"在 GitHub 上编辑此页面\"},\"lastUpdatedText\":\"最后更新于\",\"logo\":\"https://cdn.tangjiayan.com/logo.svg\",\"search\":{\"provider\":\"local\"},\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/tangjan\"}],\"sidebar\":[{\"text\":\"WELCOME\",\"link\":\"/index.md\"},{\"text\":\"更新日志\",\"link\":\"/update-log\"},{\"text\":\"未分类\",\"items\":[{\"text\":\"未分类\",\"collapsed\":true,\"items\":[{\"text\":\"向 Hyper-V 虚拟机中传输文件\",\"link\":\"/unclassified/hyper-v/transfer-files-to-vm\"},{\"text\":\"Bitvise Access Denied 问题\",\"link\":\"/unclassified/bitvise-access-denied\"}]},{\"text\":\"Git\",\"collapsed\":true,\"items\":[{\"text\":\"Git / GitHub 的基本使用\",\"link\":\"/unclassified/git/git-github\"},{\"text\":\"GitHub Connection timed out 问题\",\"link\":\"/unclassified/git/connection-timed-out\"}]},{\"text\":\"Linux\",\"collapsed\":true,\"items\":[{\"text\":\"常见命令的全称\",\"link\":\"/unclassified/linux/full-name\"},{\"text\":\"用户管理\",\"link\":\"/unclassified/linux/user\"}]},{\"text\":\"PhotoShop\",\"collapsed\":true,\"items\":[{\"text\":\"仿制图章工具\",\"link\":\"/unclassified/photoshop/clone-stamp\"}]},{\"text\":\"本科\",\"collapsed\":true,\"items\":[{\"text\":\"基于 Simulink 的 SVPWM 仿真\",\"link\":\"/unclassified/undergraduate/simulink-svpwm\"},{\"text\":\"MATLAB 拼图游戏设计\",\"link\":\"/unclassified/undergraduate/matlab-jigsaw\"},{\"text\":\"基于机器视觉 YOLO 目标检测算法的绝缘子及缺陷识别\",\"link\":\"/unclassified/undergraduate/yolo-insulator\"}]}]},{\"text\":\"建站\",\"items\":[{\"text\":\"建站\",\"collapsed\":true,\"items\":[{\"text\":\"仿豆瓣主页静态页面\",\"link\":\"/web-build/fake-douban\"},{\"text\":\"Windows 本地 Wordpress CMS 搭建\",\"link\":\"/web-build/wordpress/windows-local-wordpress\"},{\"text\":\"CAA 类型解析记录会影响 SSL 证书的申请\",\"link\":\"/web-build/caa-ssl\"},{\"text\":\"XAMPP - phpmyadmin：Error establishing a database connection\",\"link\":\"/web-build/debug/Error-establishing-a-database-connection\"},{\"text\":\"url\",\"link\":\"/web-build/url\"},{\"text\":\"jekyll 个人在线简历\",\"link\":\"/web-build/jekyll-cv.md\"},{\"text\":\"WebStackPage 个人导航站\",\"link\":\"/web-build/webstackpage.md\"}]},{\"text\":\"CSS\",\"collapsed\":true,\"items\":[{\"text\":\"linear-gradient 渐变色\",\"link\":\"/web-build/css/linear-gradient-tangjiayan\"}]},{\"text\":\"HTML\",\"collapsed\":true,\"items\":[{\"text\":\"HTML 注音元素 &lt;ruby&gt;\",\"link\":\"/web-build/html/ruby\"}]},{\"text\":\"JS\",\"collapsed\":true,\"items\":[{\"text\":\"JavaScript 初探——猜数字小游戏\",\"link\":\"/web-build/js/js-number-guessing\"},{\"text\":\"将 url 中的 query 字段显示在网页中\",\"link\":\"/web-build/js/query-display\"}]},{\"text\":\"Markdown\",\"collapsed\":true,\"items\":[{\"text\":\"GitHub-Style Table\",\"link\":\"/web-build/markdown/github-style-table\"}]},{\"text\":\"Typecho\",\"collapsed\":true,\"items\":[{\"text\":\"Debian 10 部署 Typecho\",\"link\":\"/web-build/typecho/debian10-typecho\"},{\"text\":\"Typecho首页文章没排满就换页\",\"link\":\"/web-build/typecho/typecho-page-change\"}]},{\"text\":\"VitePress\",\"collapsed\":true,\"items\":[{\"text\":\"debug\",\"collapsed\":true,\"items\":[{\"text\":\"spawn-git-ENOENT\",\"link\":\"/web-build/vitepress/debug/spawn-git-ENOENT\"},{\"text\":\"Error: listen EACCES\",\"link\":\"/web-build/vitepress/debug/listen-EACCES\"},{\"text\":\"ERR_TTY_INIT_FAILED\",\"link\":\"/web-build/vitepress/debug/ERR_TTY_INIT_FAILED\"}]},{\"text\":\"VitePress 部署到 Github Pages\",\"link\":\"/web-build/vitepress/vitepress-github-pages\"},{\"text\":\"Nginx 反向代理实现 VitePress 站点部署到腾讯云服务器\",\"link\":\"/web-build/vitepress/vitepress-tencent-cloud\"},{\"text\":\"VitePress 中使用 Katex\",\"link\":\"/web-build/vitepress/vitepress-katex\"}]},{\"text\":\"WordPress\",\"collapsed\":true,\"items\":[{\"text\":\"Windows 本地 Wordpress CMS 搭建\",\"link\":\"/web-build/wordpress/windows-local-wordpress\"}]}]},{\"text\":\"编程\",\"items\":[{\"text\":\"C++\",\"collapsed\":true,\"items\":[{\"items\":[{\"text\":\"输入/输出数据\",\"collapsed\":true,\"items\":[{\"text\":\"cin / cout\",\"link\":\"/programming/c++/input-output/cin-cout\"},{\"text\":\"getline\",\"link\":\"/programming/c++/input-output/getline\"}]},{\"text\":\"容器\",\"collapsed\":true,\"items\":[{\"text\":\"array\",\"link\":\"/programming/c++/containers/array\"}]},{\"text\":\"debug\",\"collapsed\":true,\"items\":[{\"text\":\"牛客 Do not declare C-style arrays, use std::array<> instead\",\"link\":\"/programming/c++/debug/nowcoder-use-stdarray-instead\"}]},{\"text\":\"格式说明符\",\"link\":\"/programming/c++/format-specifier\"},{\"text\":\"default - C++\",\"link\":\"/programming/c++/default\"}]}]},{\"text\":\"VS Code\",\"collapsed\":true,\"items\":[{\"text\":\"VS Code 配置 C++ 运行环境\",\"link\":\"/programming/vscode/vscode-cpp\"},{\"text\":\"使用 VS Code 进行 git commit 一直加载\",\"link\":\"/programming/vscode/commit-stuck\"},{\"text\":\"VS Code 插件 markdownlint 提示 “no-hard-tabs”\",\"link\":\"/programming/vscode/vscode-hard-tab\"}]}]},{\"text\":\"日语\",\"items\":[{\"text\":\"五十音\",\"collapsed\":true,\"items\":[{\"text\":\"五十音图\",\"link\":\"/japanese/gojuon/gojuon\"},{\"text\":\"五十音图-易混淆标色版\",\"link\":\"/japanese/gojuon/confusing-gojuon\"},{\"text\":\"五十音笔顺\",\"link\":\"/japanese/gojuon/gojuon-stroke-order\"},{\"text\":\"浊音/半浊音\",\"link\":\"/japanese/gojuon/voiced\"}]}]},{\"text\":\"嵌入式\",\"items\":[{\"text\":\"嵌入式\",\"collapsed\":true,\"items\":[{\"text\":\"STM32 命名规则\",\"link\":\"/embeded/stm32-naming-rule\"},{\"text\":\"STM32 点灯大师\",\"link\":\"/embeded/stm32-light\"},{\"text\":\"STM32 点灯大大师\",\"link\":\"/embeded/stm32-blink\"}]}]},{\"text\":\"ANTI\",\"items\":[{\"text\":\"ANTI\",\"collapsed\":true,\"items\":[{\"text\":\"ANTI 是什么\",\"link\":\"/anti/whats-anti\"},{\"text\":\"重装 v2ray - WS + TLS + Web + CloudFlare\",\"link\":\"/anti/reinstall-v2ray\"}]}]},{\"text\":\"www.tangjiayan.cn\",\"link\":\"https://www.tangjiayan.cn\"},{\"text\":\"旧笔记站\",\"link\":\"https://old-notes.tangjiayan.cn\"},{\"text\":\"CC BY-NC-SA 4.0\",\"link\":\"https://creativecommons.org/licenses/by-nc-sa/4.0/\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>